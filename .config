# ==========================================
# --- 目标硬件: X86/64 & 研凌 N3061 (PVE) ---
# ==========================================
CONFIG_TARGET_x86=y
CONFIG_TARGET_x86_64=y
CONFIG_TARGET_x86_64_DEVICE_generic=y

# --- PVE 引导修复: EFI 模式 ---
CONFIG_TARGET_IMAGES_GZIP=y
CONFIG_GRUB_IMAGES=y
CONFIG_GRUB_EFI_IMAGES=y
CONFIG_GRUB_TITLE="ImmortalWrt-N3061"
CONFIG_GRUB_TIMEOUT="0"

# --- 存储空间: 2GB (Docker/iStore 专用) ---
CONFIG_TARGET_KERNEL_PARTSIZE=64
CONFIG_TARGET_ROOTFS_PARTSIZE=2048
CONFIG_TARGET_ROOTFS_EXT4FS=y
CONFIG_TARGET_ROOTFS_SQUASHFS=y

# ==========================================
# --- [重点修复] 语言设置 (强制中文) ---
# ==========================================
CONFIG_LUCI_LANG_zh_cn=y
CONFIG_LUCI_LANG_en=y
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y
CONFIG_LUCI_DEFAULT_LANG_zh_cn=y

# ==========================================
# --- 核心系统 & 界面 ---
# ==========================================
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-base=y
CONFIG_PACKAGE_luci-main=y
CONFIG_PACKAGE_luci-mod-admin-full=y
CONFIG_PACKAGE_uhttpd=y
CONFIG_PACKAGE_uhttpd-mod-ubus=y

# --- 界面美化: Argon ---
CONFIG_PACKAGE_luci-theme-argon=y
CONFIG_PACKAGE_luci-app-argon-config=y
CONFIG_PACKAGE_luci-i18n-argon-config-zh-cn=y

# ==========================================
# --- [重点修复] iStore 应用商店 ---
# ==========================================
CONFIG_PACKAGE_luci-app-store=y
CONFIG_PACKAGE_luci-lib-taskd=y
# 确保依赖被选中
CONFIG_PACKAGE_luci-lib-xterm=y

# ==========================================
# --- 5G / 网络 / 代理 ---
# ==========================================
# 1. 代理软件: HomeProxy
CONFIG_PACKAGE_luci-app-homeproxy=y
CONFIG_PACKAGE_luci-i18n-homeproxy-zh-cn=y
CONFIG_PACKAGE_sing-box=y
CONFIG_PACKAGE_kmod-nft-tproxy=y
CONFIG_PACKAGE_kmod-nft-socket=y
CONFIG_PACKAGE_kmod-nft-fullcone=y

# 2. 5G 模块支持 (QModem)
CONFIG_PACKAGE_luci-app-qmodem=y
CONFIG_PACKAGE_luci-i18n-qmodem-zh-cn=y
CONFIG_PACKAGE_luci-app-sms-tool=y
CONFIG_PACKAGE_luci-i18n-sms-tool-zh-cn=y
CONFIG_PACKAGE_modemmanager=y
CONFIG_PACKAGE_kmod-usb-net-cdc-mbim=y
CONFIG_PACKAGE_libmbim=y
CONFIG_PACKAGE_umbim=y
CONFIG_PACKAGE_luci-proto-qmi=y
CONFIG_PACKAGE_uqmi=y
CONFIG_PACKAGE_comgt=y
CONFIG_PACKAGE_kmod-usb-serial=y
CONFIG_PACKAGE_kmod-usb-serial-option=y
CONFIG_PACKAGE_kmod-usb-serial-wwan=y
CONFIG_PACKAGE_usbutils=y

# 3. 负载均衡 (MWAN3)
CONFIG_PACKAGE_luci-app-mwan3=y
CONFIG_PACKAGE_luci-i18n-mwan3-zh-cn=y
CONFIG_PACKAGE_mwan3=y

# ==========================================
# --- Wi-Fi 稳定性增强 (AX210) ---
# ==========================================
CONFIG_PACKAGE_kmod-iwlwifi=y
CONFIG_PACKAGE_iwlwifi-firmware-ax210=y
CONFIG_PACKAGE_iw=y

# [核心] 满血版 Hostapd (WPA3 支持)
CONFIG_PACKAGE_wpad-openssl=y
CONFIG_PACKAGE_hostapd-utils=y
# 移除冲突包
# CONFIG_PACKAGE_wpad-basic is not set

# [增强] DAWN 智能控制器
CONFIG_PACKAGE_luci-app-dawn=y
CONFIG_PACKAGE_dawn=y
CONFIG_PACKAGE_luci-i18n-dawn-zh-cn=y

# ==========================================
# --- [重点修复] 扩展插件 (使用新源) ---
# ==========================================
# 1. AdGuard Home (修复安装失败)
# 使用第三方源的包名，通常更稳定
CONFIG_PACKAGE_luci-app-adguardhome=y
CONFIG_PACKAGE_luci-i18n-adguardhome-zh-cn=y
CONFIG_PACKAGE_adguardhome=y

# 2. Tailscale (修复安装失败)
CONFIG_PACKAGE_luci-app-tailscale=y
CONFIG_PACKAGE_luci-i18n-tailscale-zh-cn=y
CONFIG_PACKAGE_tailscale=y
CONFIG_PACKAGE_iptables-mod-nat-extra=y

# 3. Docker 容器平台
CONFIG_PACKAGE_docker=y
CONFIG_PACKAGE_dockerd=y
CONFIG_PACKAGE_luci-app-dockerman=y
CONFIG_PACKAGE_luci-i18n-dockerman-zh-cn=y
CONFIG_PACKAGE_iptables-mod-extra=y

# ==========================================
# --- 虚拟化 & 系统底层 ---
# ==========================================
CONFIG_PACKAGE_qemu-ga=y
CONFIG_PACKAGE_kmod-virtio-net=y
CONFIG_PACKAGE_kmod-virtio-balloon=y
CONFIG_PACKAGE_kmod-virtio-console=y
CONFIG_PACKAGE_kmod-virtio-scsi=y
CONFIG_PACKAGE_kmod-scsi-core=y

# 基础工具
CONFIG_PACKAGE_luci-app-diskman=y
CONFIG_PACKAGE_luci-i18n-diskman-zh-cn=y
CONFIG_PACKAGE_parted=y
CONFIG_PACKAGE_smartmontools=y
CONFIG_PACKAGE_luci-app-ttyd=y
CONFIG_PACKAGE_luci-i18n-ttyd-zh-cn=y
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_wget-ssl=y
CONFIG_PACKAGE_nano=y
CONFIG_PACKAGE_unzip=y
CONFIG_PACKAGE_gzip=y
CONFIG_PACKAGE_tar=y
CONFIG_PACKAGE_opkg=y
CONFIG_PACKAGE_ca-bundle=y
CONFIG_PACKAGE_ca-certificates=y
CONFIG_PACKAGE_libustream-openssl=y
CONFIG_PACKAGE_openssl-util=y
